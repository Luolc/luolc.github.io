<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Learning Personalized End-to-End Goal-Oriented Dialog</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<meta name="generator" content="Hugo 0.60.0" />
	<meta property="og:title" content="Learning Personalized End-to-End Goal-Oriented Dialog" />
<meta property="og:description" content="Abstract Most existing works on dialog systems only consider conversation content while neglecting the personality of the user the bot is interacting with, which begets several unsolved issues. In this paper, we present a personalized end-to-end model in an attempt to leverage personalization in goal-oriented dialogs. We first introduce a Profile Model which encodes user profiles into distributed embeddings and refers to conversation history from other similar users. Then a Preference Model captures user preferences over knowledge base entities to handle the ambiguity in user requests." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.luolc.com/publications/personalized-goal-oriented-dialog/" />
<meta property="article:published_time" content="2019-01-31T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-01-31T00:00:00+00:00" />

	<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Learning Personalized End-to-End Goal-Oriented Dialog"/>
<meta name="twitter:description" content="Abstract Most existing works on dialog systems only consider conversation content while neglecting the personality of the user the bot is interacting with, which begets several unsolved issues. In this paper, we present a personalized end-to-end model in an attempt to leverage personalization in goal-oriented dialogs. We first introduce a Profile Model which encodes user profiles into distributed embeddings and refers to conversation history from other similar users. Then a Preference Model captures user preferences over knowledge base entities to handle the ambiguity in user requests."/>

	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/css/style.css">
	<link rel="shortcut icon" sizes="16x16 24x24 32x32 48x48 64x64" href="/favicon.ico">
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-97612757-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

	<script type="text/x-mathjax-config">
		MathJax.Hub.Config({
			tex2jax: {
				inlineMath: [ ['$','$'], ["\\(","\\)"] ],
				processEscapes: true
			}
		});
	</script>
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo" role="banner">
			<a class="logo__link" href="/" title="Liangchen Luo" rel="home">
				<div class="logo__title">Liangchen Luo</div>
				<div class="logo__tagline">A fool living in the amazing world</div>
			</a>
		</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			
			<a class="menu__link" href="/assets/other/CV.pdf">Curriculum Vitae</a>
		</li>
		<li class="menu__item">
			
			<a class="menu__link" href="/publications/">Publications</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<section class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Learning Personalized End-to-End Goal-Oriented Dialog</h1>
			
<div class="post__tags tags clearfix">
	<svg class="icon icon-tag" width="16" height="16" viewBox="0 0 577.545 577.545">
		<g>
			<path d="M245.531,245.532c4.893-4.896,11.42-7.589,18.375-7.589s13.482,2.696,18.375,7.589l49.734,49.734    c1.723,1.72,4.058,2.689,6.49,2.689s4.771-0.967,6.49-2.689l49.733-49.734c1.724-1.72,2.69-4.058,2.69-6.49    c0-2.433-0.967-4.771-2.69-6.49l-49.733-49.734c-21.668-21.662-50.469-33.589-81.093-33.589s-59.425,11.928-81.093,33.586    L33.602,332.022C11.934,353.69,0,382.494,0,413.128c0,30.637,11.934,59.432,33.605,81.084l49.731,49.73    c21.65,21.668,50.447,33.603,81.081,33.603s59.438-11.935,81.108-33.603l84.083-84.082c2.705-2.705,3.448-6.803,1.869-10.285    c-1.496-3.295-4.776-5.386-8.356-5.386c-0.205,0-0.407,0.007-0.615,0.021c-2.959,0.199-5.958,0.297-8.917,0.297    c-23.354,0-46.322-6.208-66.417-17.956c-1.444-0.844-3.042-1.254-4.629-1.254c-2.375,0-4.725,0.921-6.494,2.689l-53.238,53.238    c-4.902,4.901-11.426,7.604-18.372,7.604c-6.949,0-13.479-2.699-18.381-7.604l-49.734-49.734    c-4.908-4.896-7.61-11.411-7.616-18.348c-0.003-6.953,2.699-13.489,7.616-18.406L245.531,245.532z"/>
			<path d="M543.942,83.324L494.208,33.59C472.556,11.931,443.762,0,413.128,0s-59.438,11.928-81.105,33.587l-84.086,84.119    c-2.705,2.705-3.448,6.806-1.867,10.288c1.497,3.292,4.777,5.382,8.354,5.382c0.205,0,0.413-0.006,0.621-0.021    c2.987-0.202,6.013-0.303,9-0.303c23.4,0,46.316,6.206,66.274,17.947c1.45,0.854,3.057,1.267,4.65,1.267    c2.375,0,4.725-0.921,6.494-2.689l53.274-53.274c4.893-4.896,11.42-7.589,18.375-7.589s13.482,2.696,18.375,7.589l49.734,49.734    c10.123,10.135,10.123,26.634-0.003,36.775L332.017,332.014c-4.894,4.905-11.408,7.604-18.348,7.604    c-6.956,0-13.495-2.702-18.415-7.61l-49.723-49.725c-1.723-1.72-4.057-2.69-6.49-2.69c-2.433,0-4.771,0.967-6.49,2.69    l-49.734,49.734c-3.586,3.586-3.586,9.397,0,12.983l49.734,49.734c21.668,21.668,50.469,33.602,81.093,33.602    c30.625,0,59.426-11.934,81.094-33.602l149.205-149.206c21.668-21.658,33.603-50.462,33.603-81.102S565.61,104.983,543.942,83.324    z"/>
		</g>
	</svg>
	<ul class="tags__list">
	<li class="tags__item"><a class="tags__link btn" href="https://arxiv.org/abs/1811.04604" rel="tag">arXiv</a></li>
	<li class="tags__item"><a class="tags__link btn" href="https://www.luolc.com/publications/personalized-goal-oriented-dialog/#bibtex" rel="tag">bib</a></li>
	<li class="tags__item"><a class="tags__link btn" href="/assets/research/personalized-goal-oriented-dialog/AAAI19-personalized-poster.pdf" rel="tag">poster</a></li>
</ul>
</div>
			<div class="pub__meta"><b>Liangchen Luo</b>, Wenhao Huang, Qi Zeng, Zaiqing Nie, Xu Sun.<br>In
<em>Proceedings of the 33rd AAAI Conference on Artificial Intelligence</em>, Honolulu, Hawaii.
2019.
			</div>
		</header><div class="content post__content clearfix">
			<h2 id="abstract">Abstract</h2>
<p>Most existing works on dialog systems only consider conversation content while neglecting the personality of the user the bot is interacting with, which begets several unsolved issues.
In this paper, we present a personalized end-to-end model in an attempt to leverage personalization in goal-oriented dialogs.
We first introduce a <span style="font-variant: small-caps">Profile Model</span> which encodes user profiles into distributed embeddings and refers to conversation history from other similar users.
Then a <span style="font-variant: small-caps">Preference Model</span> captures user preferences over knowledge base entities to handle the ambiguity in user requests.
The two models are combined into the <span style="font-variant: small-caps">Personalized MemN2N</span>.
Experiments show that the proposed model achieves qualitative performance improvements over state-of-the-art methods.
As for human evaluation, it also outperforms other approaches in terms of task completion rate and user satisfaction.</p>
<h2 id="related-work-and-resources">Related Work and Resources</h2>
<p>The personalization of dialog systems is a meaningful task, which has not received much attention in the past few years.
When this paper was initiated in Jan 2018, there were few publicly available datasets that allow researchers to train dialog systems with personalized information.
But recently, thanks to the researchers from <a href="https://research.fb.com/">FAIR</a>, several brand new personalized dialog datasets have been released to the research community.</p>
<p><a href="https://arxiv.org/abs/1801.07243">Zhang et al. (2018)</a> construct a <span style="font-variant: small-caps">Persona-Chat</span> dataset and release it on <a href="http://www.parl.ai/">ParlAI</a>.
The authors crowdsource a set of 1K+ personas, each of which consists of at least 5 natural sentences to describe the user profile.
Each dialog in this dataset is produced by two human workers assigned each with a random persona from the pool.
The dataset also serves as the resource of a <a href="http://convai.io/">shared-competition</a> in NIPS 2018.
This may hopefully attracts more researchers&rsquo; attention on this particular task.
<a href="https://arxiv.org/abs/1809.01984">Mazare et al. (2018)</a> then build a personalized dialog dataset with the same form of persona with that in <a href="https://arxiv.org/abs/1801.07243">Zhang et al. (2018)</a> based on <a href="https://www.reddit.com/r/datasets/comments/3bxlg7/">Reddit corpus</a>.
This dataset has a much larger size (5M personas and 700M dialogs), while it is in a single-turn style rather than multi-turn, which is a big weakness as the research on multi-turn dialog systems are much more important nowadays.
Besides, some previous built datasets based on movie scripts or Twitter comments can be seen as alternatives.
More details can be found in Section 2 of the paper.</p>
<p>It should be mentioned that all the resources introduced above are designed for <strong>chit-chat</strong>.
Another important type of conversational agents is <strong>goal-oriented dialog systems</strong>, including personal assistants, customer service and restaurant reservation service, etc.
These scenarios are really common in our daily life and thus personalization is also worth investigated.
Unfortunately, the research on this track remains unexplored, and there is only one publicly available dataset suitable for this task currently, called personalized bAbI dialog corpus (<a href="https://arxiv.org/abs/1706.07503">Joshi et al., 2017</a>), which is also available on <a href="http://www.parl.ai/">ParlAI</a>.</p>
<p><strong>The goals of personalization in goal-oriented dialog are much different from those in chit-chat</strong>, which will be discussed in the next paragraph.
We present several novel approaches in this paper, hoping to bring other researchers inspirations on the future directions.</p>
<h2 id="background-and-intuition">Background and Intuition</h2>
<figure style="text-align: center">
	<img src="/assets/research/personalized-goal-oriented-dialog/example-dialogs.png"/>
	<figcaption style="text-align: center">
		<p style="display: inline-block; text-align: left;">
  Figure 1(a): Three example dialogs are chosen from the personalized bAbI dialog dataset.
  Personalized and content-based responses are generated by the <span style="font-variant: small-caps">Personalized MemN2N</span> and a standard memory network, respectively.
</p>
	</figcaption>
</figure>
<figure style="text-align: center">
	<img src="/assets/research/personalized-goal-oriented-dialog/example-kb.png"/>
	<figcaption style="text-align: center">
		<p style="display: inline-block; text-align: left;">
  Figure 1(b): Examples of valid candidates from a knowledge base that match the user request.
</p>
	</figcaption>
</figure>
<p>Let's take a look at the example in Figure 1 to see what is wrong with conventional content-based goal-oriented dialog systems.</p>
<p>The conversations happen in a restaurant reservation scenario.
The agent is responsible for recommending restaurants according to the user request and providing extra information if necessary.
In all the three dialogs, the user utterances are the same.
The first and the second dialogs are with a young male with non-vegetable dietary, and the third one is with an elderly female with vegetable dietary.
The two restaurants in Figure 1(b) are valid candidates from a knowledge base that match the user request.
We can see that</p>
<ol>
<li>The responses from the content-based model are plain and boring, and it is not able to adjust appellations and language styles like the personalized model.</li>
<li>In the recommendation phase, the content-based model can only provide candidates in a random order, while a personalized model can change recommendation policy dynamically, and in this case, match the user dietary (recommends <code>The_Fancy_Pub</code> for the young male and <code>The_Place</code> for elderly female).</li>
<li>The word <code>contact</code> can be interpreted into <code>phone</code> or <code>social media</code> contact information in the knowledge base.
Instead of choosing one randomly, the personalized model handles this ambiguity based on the learned fact that young people prefer social media account while the elders prefer phone number.</li>
</ol>
<p>These problems in the above example reflect three common issues with current models:</p>
<ol>
<li>The inability to <strong>adjust language style</strong> flexibly (<a href="http://www.aclweb.org/anthology/W17-3541">Herzig et al., 2017</a>).</li>
<li>The lack of a <strong>dynamic conversation policy</strong> based on the interlocutor's profile (<a href="https://arxiv.org/abs/1706.07503">Joshi et al., 2017</a>).</li>
<li>The incapability of <strong>handling ambiguities</strong> in user requests.</li>
</ol>
<p>Correspondingly, the goals of personalization in goal-oriented dialog systems are solving these issues.
Note that they are very different from personalization in chit-chat.
Instead of assigning a consistent personality to agents, personalized agents for goal-oriented dialog pay more attention to the user persona and aim to make agents more adaptive to different kinds of interlocutors, and therefore improve the task completion rate and user satisfaction.</p>
<h2 id="model-overview">Model Overview</h2>
<figure style="text-align: center">
	<img src="/assets/research/personalized-goal-oriented-dialog/model.png"/>
	<figcaption style="text-align: center">
		<p style="display: inline-block; text-align: left;">
  Figure 2: <span style="font-variant: small-caps">Personalized MemN2N</span> architecture.
</p>
	</figcaption>
</figure>
<p>Our work is in the vein of the memory network models for goal-oriented dialog from <a href="https://arxiv.org/abs/1605.07683">Bordes et al. (2017)</a>.
Our model, <span style="font-variant: small-caps">Personalized MemN2N</span>, consists of three main components: <strong>profile embedding</strong>, <strong>global memory</strong> and <strong>personalized preference</strong>.
Here we just provide a (very) brief overview of the model.
Please check the paper for the details of the model and further analysis on how these components make contributions to the dialog system.</p>
<ul>
<li>The incoming user utterance is embedded into a query vector.
The model first reads the memory (at top-left) to find relevant history and produce attention weights.
Then it generates an output vector by taking the weighted sum followed by a linear transformation.
This part is just the original <span style="font-variant: small-caps">MemN2N</span>.</li>
<li>Part (1) is <strong>Profile Embedding</strong>: the profile vector $p$ is added to the query at each iteration, and is also used to revise the candidate responses $r$.</li>
<li>Part (2) is <strong>Global Memory</strong>: this component (at bottom-left) has an identical structure as the original <span style="font-variant: small-caps">MemN2N</span>, but it contains history utterances from other similar users.</li>
<li>Part (3) is <strong>Personalized Preference</strong>: the bias term is obtained based on the user preference and added to the prediction logits.</li>
</ul>

		</div>








<h2 id="bibtex">BibTex</h2>
<pre><code>@inproceedings{Luo2019Personalized,
  author = {Luo, Liangchen and Huang, Wenhao and Zeng, Qi and Nie, Zaiqing and Sun, Xu},
  title = {Learning Personalized End-to-End Goal-Oriented Dialog},
  booktitle = {Proceedings of the 33rd AAAI Conference on Artificial Intelligence},
  month = {January},
  year = {2019},
  address = {Honolulu, Hawaii}
}
</code></pre>
	</article>
</main>


<nav class="post-nav flex">
	<div class="post-nav__item post-nav__item--prev">
		<a class="post-nav__link" href="/publications/insight-ranking/" rel="prev"><span class="post-nav__caption">«&thinsp;Previous</span><p class="post-nav__post-title">Text Assisted Insight Ranking Using Context-Aware Memory Network</p></a>
	</div>
	<div class="post-nav__item post-nav__item--next">
		<a class="post-nav__link" href="/publications/adabound/" rel="next"><span class="post-nav__caption">Next&thinsp;»</span><p class="post-nav__post-title">Adaptive Gradient Methods with Dynamic Bound of Learning Rate</p></a>
	</div>
</nav>


			</section>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2015-2023 Liangchen Luo.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> based on <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>